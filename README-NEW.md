# 🎾 网球场预约监控插件

一个用于监控中南大学网球场预约系统的Chrome扩展插件，能够自动检测可预约时段并发送桌面通知。

## ✨ 主要功能

- 🔄 **自动刷新监控**: 定时刷新页面检测最新预约状态
- 🎯 **智能检测**: 高精度识别可预约时段，避免误报
- 🔔 **桌面通知**: 发现可预约时段立即推送通知
- 👤 **用户活动保护**: 检测用户操作，避免干扰手动预约
- ⚙️ **可调参数**: 自定义检查间隔和监控设置
- 📅 **日期选择**: 可选择监控今天或明天的场地情况

## 🚀 安装使用

1. **加载扩展**:
   - 打开Chrome浏览器
   - 进入 `chrome://extensions/`
   - 开启"开发者模式"
   - 点击"加载已解压的扩展程序"
   - 选择插件文件夹

2. **开始监控**:
   - 访问中南大学网球场预约页面
   - 点击扩展图标打开弹窗
   - 点击"开始监控"按钮
   - 插件将自动监控并在发现可预约时段时通知您

## 🔧 最新优化 (v2.0)

### 监控准确性大幅提升

- **智能容器选择**: 优先检测精确的预约相关容器
- **严格内容验证**: 必须包含时间、场地、价格等信息
- **精确置信度评分**: 提高准确性阈值到70%
- **智能去重算法**: 避免重复通知相同时段
- **增强重试机制**: 自动处理页面加载不完整的情况
- **日期选择功能**: 可选择监控今天或明天的场地情况

### 🔍 使用提示

为获得最佳效果，请注意：

1. **选择监控日期**: 默认监控"明天"场地情况，可改为"今天"
2. **页面加载耐心等待**: 插件会多次尝试确保页面完全加载
3. **避免频繁操作**: 有操作时会暂停自动刷新以免打断您

### 📊 调试方法

1. 按F12打开控制台查看详细日志
2. 搜索 `🔍` 查看检测过程
3. 搜索 `✨` 查看发现的时段
4. 搜索 `📊` 查看统计信息

## 🧪 测试工具

使用 `simple-test.html` 测试监控功能：

```bash
# 直接在浏览器中打开
simple-test.html
```

测试页面功能：
- 包含真实的预约表格数据
- 动态添加/移除可预约时段
- 实时调试信息显示
- 模拟页面加载状态

## 📁 文件结构

```
├── manifest.json         # 扩展配置文件
├── background.js         # 后台监控脚本 ⭐ 核心文件
├── popup.html           # 弹窗界面
├── popup.js             # 弹窗逻辑
├── content.js           # 内容脚本
├── simple-test.html     # 简化测试页面
├── icons/               # 扩展图标
└── README.md           # 说明文档
```

## ⚙️ 配置参数

- **检查间隔**: 默认30秒，可在弹窗中调整
- **监控日期**: 可选择"今天"或"明天"（默认为明天）
- **置信度阈值**: 70%（代码中可调整）
- **用户活动保护**: 10秒内有操作则暂停刷新
- **重试次数**: 最多3次重试

## 🔧 故障排除

### 1. 监控无效果
- 确认扩展已正确加载
- 检查是否在正确的预约页面
- 查看控制台是否有错误信息

### 2. 自动刷新后无通知
- 检查页面是否完全加载
- 查看控制台中的置信度分数
- 确认检测到的内容质量是否达标

### 3. 通知重复或误报
- 检查去重逻辑是否正常
- 调整排除关键词
- 降低置信度阈值（如需要）

## 📈 性能优化

- ✅ 避免过于宽泛的DOM查询
- ✅ 智能相似度计算减少重复
- ✅ 合理的重试和等待时间
- ✅ 内存使用优化

## 🛠️ 开发说明

主要文件说明：
- `background.js`: 核心监控逻辑，包含智能检测算法
- `popup.js`: 用户界面交互
- `simple-test.html`: 测试页面，验证监控准确性

## 📞 支持

如有问题请：
1. 查看控制台日志
2. 使用测试页面验证功能
3. 检查 `OPTIMIZATION_GUIDE.md` 详细说明

---

**版本**: 2.0  
**更新时间**: 2025年7月2日  
**兼容**: Chrome浏览器
